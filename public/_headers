# Security headers configured in next.config.ts - this file serves as backup for static files
# NOTE: For SSR/dynamic routes, Next.js headers() in next.config.ts takes precedence

# =============================================================================
# CACHE CONTROL HEADERS
# =============================================================================

# Next.js hashed static assets (JS, CSS chunks) - immutable, cache 1 year
/_next/static/*
  Cache-Control: public, max-age=31536000, immutable

# Fonts (Google Fonts self-hosted by Next.js) - cache 1 year
/_next/static/media/*.woff2
  Cache-Control: public, max-age=31536000, immutable

# Static public assets (favicons, icons, manifest) - cache 1 week, revalidate
/*.png
  Cache-Control: public, max-age=604800, stale-while-revalidate=86400
/*.ico
  Cache-Control: public, max-age=604800, stale-while-revalidate=86400
/manifest.json
  Cache-Control: public, max-age=604800, stale-while-revalidate=86400

# Service worker - always revalidate (must stay fresh for updates)
/sw.js
  Cache-Control: public, max-age=0, must-revalidate

# Static text files
/robots.txt
  Cache-Control: public, max-age=86400, stale-while-revalidate=43200
/llms.txt
  Cache-Control: public, max-age=86400, stale-while-revalidate=43200
/ads.txt
  Cache-Control: public, max-age=86400, stale-while-revalidate=43200
/sitemap.xml
  Cache-Control: public, max-age=3600, stale-while-revalidate=1800

# =============================================================================
# SECURITY HEADERS
# =============================================================================

# Less restrictive CSP for Sanity Studio
/studio/*
  Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https: data:; style-src 'self' 'unsafe-inline' https: data:; font-src 'self' https: data:; img-src 'self' data: https: blob:; media-src 'self' https: data:; connect-src 'self' https: wss: ws:; frame-src 'self' https:; object-src 'none'; base-uri 'self'; form-action 'self' https:; frame-ancestors 'none'; upgrade-insecure-requests
  X-Content-Type-Options: nosniff
  Referrer-Policy: strict-origin-when-cross-origin
  X-DNS-Prefetch-Control: on
  Permissions-Policy: camera=(), microphone=(), geolocation=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()
  Strict-Transport-Security: max-age=31536000; includeSubDomains; preload

# Stricter CSP for all other routes (updated for Cloudflare Zaraz + AdSense + Cookiebot)
/*
  Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://*.cookiebot.com https://fundingchoicesmessages.google.com https://*.google-analytics.com https://analytics.google.com https://static.cloudflareinsights.com https://*.klaviyo.com https://js.sentry-cdn.com https://*.sentry.io https://*.trustpilot.com https://connect.facebook.net https://pagead2.googlesyndication.com https://*.doubleclick.net https://www.googletagservices.com blob:; worker-src 'self' blob:; style-src 'self' 'unsafe-inline' https://*.klaviyo.com https://*.trustpilot.com https://*.cookiebot.com; font-src 'self' https://*.trustpilot.com data:; img-src 'self' data: https: blob:; media-src 'self' https:; connect-src 'self' https://*.cookiebot.com https://fundingchoicesmessages.google.com https://*.google-analytics.com https://*.googletagmanager.com https://analytics.google.com https://*.google.com https://*.google.co.uk https://*.doubleclick.net https://*.klaviyo.com https://*.kmail-lists.com https://*.shopify.com https://*.myshopify.com https://cdn.sanity.io https://*.sanity.io https://*.sentry.io https://cloudflareinsights.com https://*.trustpilot.com https://*.facebook.com https://*.facebook.net https://*.googlesyndication.com https://*.tiktok.com wss: ws:; frame-src 'self' https://*.cookiebot.com https://www.youtube.com https://www.vimeo.com https://*.sanity.io https://*.trustpilot.com https://*.instagram.com https://*.cdninstagram.com https://*.doubleclick.net https://*.googlesyndication.com https://*.googletagmanager.com about: data:; object-src 'none'; base-uri 'self'; form-action 'self' https://manage.kmail-lists.com; frame-ancestors 'none'; upgrade-insecure-requests
  X-Content-Type-Options: nosniff
  Referrer-Policy: strict-origin-when-cross-origin
  X-DNS-Prefetch-Control: on
  Permissions-Policy: camera=(), microphone=(), geolocation=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()
  Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
